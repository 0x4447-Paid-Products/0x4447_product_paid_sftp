{
	"CloudWatchDashboardInstances": {
		"Type": "AWS::CloudWatch::Dashboard",
		"Properties": {
			"DashboardName": { "Fn::Sub": "sftp_user_single_${UniqueIdentifierParam}_${AWS::Region}" },
			"DashboardBody": {
				"Fn::Sub": [
					"{\r\n    \"widgets\": [\r\n        {\r\n            \"type\": \"metric\",\r\n            \"x\": 0,\r\n            \"y\": 4,\r\n            \"width\": 24,\r\n            \"height\": 3,\r\n            \"properties\": {\r\n                \"metrics\": [\r\n                    [ \"AWS\/EC2\", \"CPUUtilization\", \"InstanceId\", \"${InstanceId}\" ]\r\n                ],\r\n                \"view\": \"timeSeries\",\r\n                \"stacked\": false,\r\n                \"region\": \"${region}\",\r\n                \"title\": \"CPU\",\r\n                \"period\": 300,\r\n                \"stat\": \"Average\"\r\n            }\r\n        },\r\n        {\r\n            \"type\": \"metric\",\r\n            \"x\": 0,\r\n            \"y\": 1,\r\n            \"width\": 24,\r\n            \"height\": 3,\r\n            \"properties\": {\r\n                \"view\": \"timeSeries\",\r\n                \"stacked\": false,\r\n                \"metrics\": [\r\n                    [ \"AWS\/EC2\", \"NetworkIn\", \"InstanceId\", \"${InstanceId}\" ],\r\n                    [ \".\", \"NetworkOut\", \".\", \".\" ]\r\n                ],\r\n                \"region\": \"${region}\",\r\n                \"title\": \"Network\"\r\n            }\r\n        },\r\n        {\r\n            \"type\": \"metric\",\r\n            \"x\": 0,\r\n            \"y\": 7,\r\n            \"width\": 24,\r\n            \"height\": 3,\r\n            \"properties\": {\r\n                \"metrics\": [\r\n                    [ \"AWS\/EC2\", \"CPUCreditBalance\", \"InstanceId\", \"${InstanceId}\", { \"yAxis\": \"right\" } ],\r\n                    [ \".\", \"CPUSurplusCreditsCharged\", \".\", \".\" ],\r\n                    [ \".\", \"CPUCreditUsage\", \".\", \".\" ]\r\n                ],\r\n                \"view\": \"timeSeries\",\r\n                \"stacked\": false,\r\n                \"region\": \"${region}\",\r\n                \"stat\": \"Average\",\r\n                \"period\": 300,\r\n                \"title\": \"CPU Credit Balance\"\r\n            }\r\n        },\r\n        {\r\n            \"type\": \"metric\",\r\n            \"x\": 3,\r\n            \"y\": 10,\r\n            \"width\": 21,\r\n            \"height\": 3,\r\n            \"properties\": {\r\n                \"metrics\": [\r\n                    [ \"CWAgent\", \"mem_available\", \"InstanceId\", \"${InstanceId}\", \"InstanceType\", \"${InstanceType}\", { \"color\": \"#2ca02c\" } ],\r\n                    [ \".\", \"mem_used\", \".\", \".\", \".\", \".\", { \"color\": \"#d62728\" } ]\r\n                ],\r\n                \"view\": \"timeSeries\",\r\n                \"stacked\": false,\r\n                \"region\": \"${region}\",\r\n                \"stat\": \"Average\",\r\n                \"period\": 300,\r\n                \"title\": \"RAM\"\r\n            }\r\n        },\r\n        {\r\n            \"type\": \"metric\",\r\n            \"x\": 0,\r\n            \"y\": 10,\r\n            \"width\": 3,\r\n            \"height\": 3,\r\n            \"properties\": {\r\n                \"view\": \"singleValue\",\r\n                \"stacked\": false,\r\n                \"metrics\": [\r\n                    [ \"CWAgent\", \"mem_total\", \"InstanceId\", \"${InstanceId}\", \"InstanceType\", \"${InstanceType}\" ]\r\n                ],\r\n                \"region\": \"${region}\",\r\n                \"period\": 300,\r\n                \"title\": \"Total\"\r\n            }\r\n        },\r\n        {\r\n            \"type\": \"metric\",\r\n            \"x\": 3,\r\n            \"y\": 16,\r\n            \"width\": 21,\r\n            \"height\": 3,\r\n            \"properties\": {\r\n                \"view\": \"timeSeries\",\r\n                \"stacked\": false,\r\n                \"metrics\": [\r\n                    [ \"AWS\/EFS\", \"TotalIOBytes\", \"FileSystemId\", \"${FileSystemId}\" ]\r\n                ],\r\n                \"region\": \"${region}\",\r\n                \"title\": \"EFS Size\"\r\n            }\r\n        },\r\n        {\r\n            \"type\": \"metric\",\r\n            \"x\": 0,\r\n            \"y\": 16,\r\n            \"width\": 3,\r\n            \"height\": 3,\r\n            \"properties\": {\r\n                \"metrics\": [\r\n                    [ \"AWS\/EFS\", \"TotalIOBytes\", \"FileSystemId\", \"${FileSystemId}\" ]\r\n                ],\r\n                \"view\": \"singleValue\",\r\n                \"stacked\": false,\r\n                \"region\": \"${region}\",\r\n                \"title\": \"EFS Size\",\r\n                \"period\": 300,\r\n                \"stat\": \"Maximum\"\r\n            }\r\n        },\r\n        {\r\n            \"type\": \"text\",\r\n            \"x\": 0,\r\n            \"y\": 0,\r\n            \"width\": 24,\r\n            \"height\": 1,\r\n            \"properties\": {\r\n                \"markdown\": \"\\n# EC2\\n\"\r\n            }\r\n        },\r\n        {\r\n            \"type\": \"text\",\r\n            \"x\": 0,\r\n            \"y\": 15,\r\n            \"width\": 24,\r\n            \"height\": 1,\r\n            \"properties\": {\r\n                \"markdown\": \"\\n# EFS\\n\"\r\n            }\r\n        },\r\n        {\r\n            \"type\": \"metric\",\r\n            \"x\": 3,\r\n            \"y\": 19,\r\n            \"width\": 21,\r\n            \"height\": 3,\r\n            \"properties\": {\r\n                \"view\": \"timeSeries\",\r\n                \"stacked\": false,\r\n                \"metrics\": [\r\n                    [ \"AWS\/EFS\", \"DataReadIOBytes\", \"FileSystemId\", \"${FileSystemId}\" ],\r\n                    [ \".\", \"DataWriteIOBytes\", \".\", \".\" ]\r\n                ],\r\n                \"region\": \"${region}\",\r\n                \"title\": \"Read & Write\"\r\n            }\r\n        },\r\n        {\r\n            \"type\": \"alarm\",\r\n            \"x\": 0,\r\n            \"y\": 13,\r\n            \"width\": 24,\r\n            \"height\": 2,\r\n            \"properties\": {\r\n                \"title\": \"Alarms\",\r\n                \"alarms\": [\r\n                    \"arn:aws:cloudwatch:${region}:${AccountId}:alarm:sftp_user_single_${UniqueIdentifier}_${region}_ec2_recovery\",\r\n                    \"arn:aws:cloudwatch:${region}:${AccountId}:alarm:sftp_user_single_${UniqueIdentifier}_${region}_cpu_load\",\r\n                    \"arn:aws:cloudwatch:${region}:${AccountId}:alarm:sftp_user_single_${UniqueIdentifier}_${region}_cpu_burst\"\r\n                ]\r\n            }\r\n        },\r\n        {\r\n            \"type\": \"metric\",\r\n            \"x\": 0,\r\n            \"y\": 19,\r\n            \"width\": 3,\r\n            \"height\": 3,\r\n            \"properties\": {\r\n                \"view\": \"pie\",\r\n                \"stacked\": false,\r\n                \"metrics\": [\r\n                    [ \"AWS\/EFS\", \"DataReadIOBytes\", \"FileSystemId\", \"${FileSystemId}\" ],\r\n                    [ \".\", \"DataWriteIOBytes\", \".\", \".\" ]\r\n                ],\r\n                \"region\": \"${region}\",\r\n                \"title\": \"Read & Write\",\r\n                \"period\": 300,\r\n                \"setPeriodToTimeRange\": true\r\n            }\r\n        }\r\n    ]\r\n}",
					{
						"InstanceId": { "Ref": "EC2Instance" },
						"InstanceType": { "Ref": "InstanceTypeParam" },
						"region": { "Ref": "AWS::Region" },
						"AccountId": { "Ref": "AWS::AccountId" },
						"UniqueIdentifier": { "Ref": "UniqueIdentifierParam" },
						"FileSystemId": { "Ref": "EFS" }
					}
				]
			}
		}
	}
}